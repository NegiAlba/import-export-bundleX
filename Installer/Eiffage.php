<?php

namespace Galilee\ImportExportBundle\Installer;

use Galilee\ImportExportBundle\Helper\AttributeHelper;
use Pimcore\Model\DataObject;

class Eiffage extends AbstractInstaller
{

    const NEW_ITEM_UNIT_VALUES = [
        'BAR',
        'BID',
        'BTE',
        'BTL',
        'COU',
        'CTN',
        'DJ',
        'ENS',
        'F',
        'FUT',
        'H',
        'J',
        'KG',
        'KMT',
        'KWH',
        'L',
        'LOT',
        'M',
        'M2',
        'M3',
        'ML',
        'MOI',
        'P1',
        'PAL',
        'PR',
        'QJ',
        'ROU',
        'SA',
        'SAC',
        'SE',
        'SEM',
        'T',
        'TOU',
        'TR',
        'TRI',
        'U'
    ];

    const NEW_ITEM_EXT_CATEGORY_ID_VALUES = [
        'AE0001',
        'AE0002',
        'AE0003',
        'AE0004',
        'AE0005',
        'AE0501',
        'AE0502',
        'AE0503',
        'AE0504',
        'AE1001',
        'AE1002',
        'AE1003',
        'AE1004',
        'AE1006',
        'AE1007',
        'AE1008',
        'AE1009',
        'AE1010',
        'AE1011',
        'AE1012',
        'AE1013',
        'AE1014',
        'AE1099',
        'AE1501',
        'AE2001',
        'AE2002',
        'AE200301',
        'AE200302',
        'AE200303',
        'AE200304',
        'AE200305',
        'AE200306',
        'AE200307',
        'AE200401',
        'AE200402',
        'AE2005',
        'AE2501',
        'AE3001',
        'AE3002',
        'CE0001',
        'CE0501',
        'CE0502',
        'CE0504',
        'CE0505',
        'CE0599',
        'CE1001',
        'CE1002',
        'CE1003',
        'CE1501',
        'CE2001',
        'CE2501',
        'CE2502',
        'CE2503',
        'FE0002',
        'FE0003',
        'FE0004',
        'FE0005',
        'FE0099',
        'FE0501',
        'FE0503',
        'FE0504',
        'FE0505',
        'FE0506',
        'FE0507',
        'FE0508',
        'FE0509',
        'FE0510',
        'FE0511',
        'FE0512',
        'FE0513',
        'FE0514',
        'FE0515',
        'FE0516',
        'FE0517',
        'FE0518',
        'FE0599',
        'FE1002',
        'FE1003',
        'FE1004',
        'FE1005',
        'FE1006',
        'FE1007',
        'FE1008',
        'FE1009',
        'FE1010',
        'FE1011',
        'FE1012',
        'FE1013',
        'FE1014',
        'FE1015',
        'FE1016',
        'FE1017',
        'FE1018',
        'FE1019',
        'FE1099',
        'FE10001',
        'FE10002',
        'FE10003',
        'FE10501',
        'FE10502',
        'FE10503',
        'FE10504',
        'FE10505',
        'FE10506',
        'FE10508',
        'FE10509',
        'FE10510',
        'FE10599',
        'FE11001',
        'FE11002',
        'FE11003',
        'FE11004',
        'FE11005',
        'FE11006',
        'FE11007',
        'FE11008',
        'FE11009',
        'FE11010',
        'FE11011',
        'FE11012',
        'FE11013',
        'FE11014',
        'FE11015',
        'FE11016',
        'FE11017',
        'FE11018',
        'FE11019',
        'FE11020',
        'FE11021',
        'FE11022',
        'FE11023',
        'FE11024',
        'FE11025',
        'FE11026',
        'FE11027',
        'FE11028',
        'FE12001',
        'FE12501',
        'FE13001',
        'FE13002',
        'FE13003',
        'FE13004',
        'FE13005',
        'FE13006',
        'FE13007',
        'FE13008',
        'FE13501',
        'FE13502',
        'FE14001',
        'FE14002',
        'FE14003',
        'FE14004',
        'FE14005',
        'FE1503',
        'FE1504',
        'FE1599',
        'FE15099',
        'FE2001',
        'FE2002',
        'FE200301',
        'FE200302',
        'FE200303',
        'FE200304',
        'FE200305',
        'FE200306',
        'FE200307',
        'FE2004',
        'FE2005',
        'FE2006',
        'FE2007',
        'FE2008',
        'FE2099',
        'FE2501',
        'FE2502',
        'FE2503',
        'FE2504',
        'FE2505',
        'FE2506',
        'FE2507',
        'FE2508',
        'FE2599',
        'FE3001',
        'FE3002',
        'FE3003',
        'FE3004',
        'FE3005',
        'FE3006',
        'FE3099',
        'FE3501',
        'FE3502',
        'FE3503',
        'FE3504',
        'FE3505',
        'FE3506',
        'FE3507',
        'FE3508',
        'FE3509',
        'FE3510',
        'FE3511',
        'FE3599',
        'FE4001',
        'FE450101',
        'FE450102',
        'FE450103',
        'FE450104',
        'FE450105',
        'FE450106',
        'FE450107',
        'FE450108',
        'FE450109',
        'FE450110',
        'FE450111',
        'FE450112',
        'FE450113',
        'FE450114',
        'FE450115',
        'FE450116',
        'FE450201',
        'FE450202',
        'FE450203',
        'FE450204',
        'FE450205',
        'FE450206',
        'FE450207',
        'FE450208',
        'FE450301',
        'FE450302',
        'FE4503',
        'FE500101',
        'FE500102',
        'FE500103',
        'FE500104',
        'FE500105',
        'FE500201',
        'FE500202',
        'FE500203',
        'FE500204',
        'FE500205',
        'FE500206',
        'FE500207',
        'FE500208',
        'FE500209',
        'FE500210',
        'FE500211',
        'FE500212',
        'FE500213',
        'FE500214',
        'FE500215',
        'FE500216',
        'FE500217',
        'FE500218',
        'FE500219',
        'FE500220',
        'FE500221',
        'FE500301',
        'FE500302',
        'FE500303',
        'FE500304',
        'FE500305',
        'FE500306',
        'FE500307',
        'FE500308',
        'FE500401',
        'FE500402',
        'FE500403',
        'FE500404',
        'FE500405',
        'FE500406',
        'FE500407',
        'FE500408',
        'FE500409',
        'FE500410',
        'FE500411',
        'FE500412',
        'FE500413',
        'FE500414',
        'FE500415',
        'FE500416',
        'FE500417',
        'FE500418',
        'FE500419',
        'FE500420',
        'FE500421',
        'FE500422',
        'FE500423',
        'FE500424',
        'FE500425',
        'FE500501',
        'FE500502',
        'FE500503',
        'FE500504',
        'FE500505',
        'FE500506',
        'FE500601',
        'FE500602',
        'FE500701',
        'FE500702',
        'FE500703',
        'FE500704',
        'FE500705',
        'FE500706',
        'FE500707',
        'FE500801',
        'FE500802',
        'FE500803',
        'FE500804',
        'FE500805',
        'FE500806',
        'FE500807',
        'FE500808',
        'FE500809',
        'FE500810',
        'FE500811',
        'FE500901',
        'FE500902',
        'FE500903',
        'FE500904',
        'FE500905',
        'FE500906',
        'FE500907',
        'FE500908',
        'FE500909',
        'FE500910',
        'FE500911',
        'FE500912',
        'FE500913',
        'FE500914',
        'FE500915',
        'FE500916',
        'FE500917',
        'FE500918',
        'FE500919',
        'FE501001',
        'FE501002',
        'FE501003',
        'FE501004',
        'FE501005',
        'FE501006',
        'FE501007',
        'FE501008',
        'FE501009',
        'FE501010',
        'FE501011',
        'FE501012',
        'FE501013',
        'FE501014',
        'FE501101',
        'FE501102',
        'FE501103',
        'FE501104',
        'FE501105',
        'FE501106',
        'FE501199',
        'FE501201',
        'FE501202',
        'FE501203',
        'FE501204',
        'FE501205',
        'FE501206',
        'FE501207',
        'FE501208',
        'FE501209',
        'FE501210',
        'FE501211',
        'FE501212',
        'FE501213',
        'FE501214',
        'FE501301',
        'FE501399',
        'FE501303',
        'FE501304',
        'FE501401',
        'FE501402',
        'FE501403',
        'FE501404',
        'FE501405',
        'FE501406',
        'FE5015',
        'FE501601',
        'FE501602',
        'FE501603',
        'FE501604',
        'FE501605',
        'FE501606',
        'FE501607',
        'FE501608',
        'FE501609',
        'FE501610',
        'FE501611',
        'FE501612',
        'FE501613',
        'FE501614',
        'FE501615',
        'FE501616',
        'FE501617',
        'FE501618',
        'FE501619',
        'FE501620',
        'FE501621',
        'FE501622',
        'FE501623',
        'FE5099',
        'FE5501',
        'FE5502',
        'FE5504',
        'FE5505',
        'FE5506',
        'FE5507',
        'FE5508',
        'FE5509',
        'FE5599',
        'FE6001',
        'FE6002',
        'FE6003',
        'FE6004',
        'FE6005',
        'FE6006',
        'FE6008',
        'FE6099',
        'FE6501',
        'FE6502',
        'FE6503',
        'FE6504',
        'FE6505',
        'FE6506',
        'FE6507',
        'FE7001',
        'FE7002',
        'FE7003',
        'FE7004',
        'FE7005',
        'FE7006',
        'FE7501',
        'FE7502',
        'FE7503',
        'FE7504',
        'FE7505',
        'FE7506',
        'FE750801',
        'FE750802',
        'FE750803',
        'FE7599',
        'FE800101',
        'FE800102',
        'FE800103',
        'FE800104',
        'FE8002',
        'FE8003',
        'FE8004',
        'FE800501',
        'FE800502',
        'FE8006',
        'FE800701',
        'FE800702',
        'FE800703',
        'FE800704',
        'FE8008',
        'FE8009',
        'FE8010',
        'FE8099',
        'FE8501',
        'FE8502',
        'FE8503',
        'FE8504',
        'FE8505',
        'FE8506',
        'FE8507',
        'FE8508',
        'FE8509',
        'FE8510',
        'FE8511',
        'FE8599',
        'FE9001',
        'FE9002',
        'FE9003',
        'FE9004',
        'FE9005',
        'FE9006',
        'FE9007',
        'FE9008',
        'FE9009',
        'FE9010',
        'FE9011',
        'FE9012',
        'FE9013',
        'FE9014',
        'FE9015',
        'FE9016',
        'FE9017',
        'FE9018',
        'FE9099',
        'FE9501',
        'FE9502',
        'FE9503',
        'FE9504',
        'FE9505',
        'FE9506',
        'FE9507',
        'FE9508',
        'FE9599',
        'JE0001',
        'JE0002',
        'JE0003',
        'JE0004',
        'JE0005',
        'JE0501',
        'JE0502',
        'JE0503',
        'JE0504',
        'JE0505',
        'JE0506',
        'JE0599',
        'JE1001',
        'JE1501',
        'JE2001',
        'JE2002',
        'JE2501',
        'JE2502',
        'JE2503',
        'JE2504',
        'LE0001',
        'LE0002',
        'LE0003',
        'LE0004',
        'LE0005',
        'LE0006',
        'LE0007',
        'LE0501',
        'LE0502',
        'LE0503',
        'LE0504',
        'LE0505',
        'LE0506',
        'LE0507',
        'LE0508',
        'LE0509',
        'LE0510',
        'LE0511',
        'LE0512',
        'LE0513',
        'LE0514',
        'LE0515',
        'LE0516',
        'LE0517',
        'LE0518',
        'LE0519',
        'LE0520',
        'LE0521',
        'LE0522',
        'LE0523',
        'LE0524',
        'LE0525',
        'LE0526',
        'LE0527',
        'LE0528',
        'LE0529',
        'LE0530',
        'LE0531',
        'LE0532',
        'LE0533',
        'LE0534',
        'LE0535',
        'LE0599',
        'LE1001',
        'LE1002',
        'LE1003',
        'LE1004',
        'LE1005',
        'LE1099',
        'LE1501',
        'LE1502',
        'LE1503',
        'LE1504',
        'LE1505',
        'LE1599',
        'KE0102',
        'KE0103',
        'KE0104',
        'KE0105',
        'KE0106',
        'KE0107',
        'KE0108',
        'KE0109',
        'KE0110',
        'KE0111',
        'KE0112',
        'KE0113',
        'FE8001',
        'FE8005',
        'FE8007',
        'FE7508',
        'FE5001',
        'FE5002',
        'FE5003',
        'FE5004',
        'FE5005',
        'FE5006',
        'FE5007',
        'FE5008',
        'FE5009',
        'FE5010',
        'FE5011',
        'FE5012',
        'FE5013',
        'FE5014',
        'FE5016',
        'FE4501',
        'FE4502',
        'FE2003',
        'AE2003',
        'AE2004',
    ];

    /**
     * @throws \Exception
     */
    public function install()
    {
        $newItemUnitPath = DIRECTORY_SEPARATOR . 'unité de vente EIFFAGE';
        $parent = DataObject\Service::createFolderByPath($newItemUnitPath);
        foreach (self::NEW_ITEM_UNIT_VALUES as $value) {
            try {
                $object = new DataObject\NewItemUnit();
                $object->setKey($value)->setLabel($value)->setParent($parent)->setPublished(true)->save();
                $this->output->writeln($value . ' attribute successfully created.');
            } catch (\Exception $exception) {
                continue;
            }
        }

        $newItemExtCategoryIdPath = DIRECTORY_SEPARATOR . 'catégories EIFFAGE';
        $parent = DataObject\Service::createFolderByPath($newItemExtCategoryIdPath);
        foreach (self::NEW_ITEM_EXT_CATEGORY_ID_VALUES as $value) {
            try {
                $object = new DataObject\NewItemExtCategoryId();
                $object->setKey($value)->setLabel($value)->setParent($parent)->setPublished(true)->save();
                $this->output->writeln($value . ' attribute successfully created.');
            } catch (\Exception $exception) {
                continue;
            }
        }

        $this->createAttributes();
    }

    /**
     * @throws \Exception
     */
    protected function createAttributes()
    {
        $path = '/' . AttributeHelper::PARENT_FOLDER_ATTRIBUTE_KEY;
        $parent = DataObject\Service::createFolderByPath($path);

        $commonValues = [
            'parent' => $parent,
            'frontendInput' => 'select',
            'isSearchable' => true,
            'isFilterable' => true,
            'isVisibleOnFront' => true,
            'published' => true,
            'locked' => true,
            'group' => 'Eiffage',
        ];

        $key = 'new_item_unit';
        $values = array_merge($commonValues, [
            'attributeCode' => $key,
            'frontendLabel' => 'Unité de vente Eiffage'
        ]);
        $this->create($path, $key, $values);

        $key = 'new_item_ext_category_id';
        $values = array_merge($commonValues, [
            'attributeCode' => $key,
            'frontendLabel' => 'Catégorie Eiffage'
        ]);
        $this->create($path, $key, $values);
    }

    /**
     * @param $path
     * @param $key
     * @param $values
     *
     * @throws \Exception
     */
    protected function create($path, $key, $values)
    {
        if (!DataObject\Service::pathExists($path . '/' . $key)) {
            $object = new DataObject\Attribute();
            $object->setKey($key)->setValues($values)->save();
            $this->output->writeln($key . ' attribute successfully created.');
        }
    }
}
